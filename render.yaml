services:
  - type: web
    name: cv-ats
    env: node
    plan: free
    buildCommand: 'mkdir -p /opt/render/.cache/puppeteer && npm ci && PUPPETEER_CACHE_DIR=/opt/render/.cache/puppeteer PUPPETEER_PRODUCT=chrome PUPPETEER_SKIP_DOWNLOAD=false npx puppeteer browsers install chrome && ls -la /opt/render/.cache/puppeteer || true && npm run build'
    startCommand: 'npm start'
    envVars:
      - key: NODE_ENV
        value: production
      - key: PUPPETEER_SKIP_DOWNLOAD
        value: 'false'
      - key: PUPPETEER_PRODUCT
        value: chrome
      - key: PUPPETEER_CACHE_DIR
        value: /opt/render/.cache/puppeteer